<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-BUAA/本科/面向对象设计与构造/OO-第二单元总结">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.21">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-rh="true">2020 OO 第二单元总结 | L1l</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mondaycha.github.io/BUAA/本科/面向对象设计与构造/OO-第二单元总结"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="2020 OO 第二单元总结 | L1l"><meta data-rh="true" name="description" content="一、设计策略"><meta data-rh="true" property="og:description" content="一、设计策略"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mondaycha.github.io/BUAA/本科/面向对象设计与构造/OO-第二单元总结"><link data-rh="true" rel="alternate" href="https://mondaycha.github.io/BUAA/本科/面向对象设计与构造/OO-第二单元总结" hreflang="en"><link data-rh="true" rel="alternate" href="https://mondaycha.github.io/BUAA/本科/面向对象设计与构造/OO-第二单元总结" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.fbc2a011.css">
<link rel="preload" href="/assets/js/runtime~main.f1753f1f.js" as="script">
<link rel="preload" href="/assets/js/main.b373ddf5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="MondayCha" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="MondayCha" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">L1l</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/MondayCha" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_lCJq"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">主页</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Algorithm/LeetCode/分隔链表">Algorithm</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/BUAA/本科/操作系统实验/操作系统-OS-Lab0-实验报告">BUAA</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/BUAA/本科/操作系统实验/操作系统-OS-Lab0-实验报告">本科</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/BUAA/本科/操作系统实验/操作系统-OS-Lab0-实验报告">操作系统实验</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/BUAA/本科/航空航天概论/「航空航天概论」Week10">航空航天概论</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/BUAA/本科/软件工程/写在「软件工程」开课之前">软件工程</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO-JML语言理论基础与工具链总结">面向对象设计与构造</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO-JML语言理论基础与工具链总结">2020 OO JML语言理论基础与工具链总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO-第二单元总结">2020 OO 第二单元总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO-第四单元总结">2020 OO 第四单元总结</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/Java求解一类特定表达式的化简思路探讨">Java求解一类特定表达式的化简思路探讨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO-第一单元总结-表达式求导">OO 第一单元总结 表达式求导</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/OO预习第三弹">OO预习第三弹</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/为圣杯战争的开始献上礼炮">为圣杯战争的开始献上礼炮</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/简陋的Java生产者消费者模型">简陋的Java生产者消费者模型</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/BUAA/本科/面向对象设计与构造/面向过程的设计，和面向对象的设计异同点到底在哪？">面向过程的设计，和面向对象的设计异同点到底在哪？</a></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Courses/MIT-6.824/MIT-6.824-Lab-1">Courses</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/Software/Frontend/从Hexo到Docusaurus">Software</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_GujU"><div class="docItemContainer_Adtb"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">BUAA</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">本科</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">面向对象设计与构造</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">2020 OO 第二单元总结</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_aoJ5"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>只要跑得够快即使从头关到尾你也喜欢吗</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="一设计策略">一、设计策略<a class="hash-link" href="#一设计策略" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-总体策略概述">1.1 总体策略概述<a class="hash-link" href="#11-总体策略概述" title="Direct link to heading">​</a></h3><p>在多线程的协同和同步控制方面，我三次作业都是采用生产者/消费者模式（还憨憨地在内部分了customer、producer、tray的包……方便自己看orz）。</p><p>其中“生产者”为输入线程，将读取到的Request放到“货架”Scheduler上；“消费者”则是每个电梯线程，以一种类似观察者模式的方式追踪“货架”Scheduler的变化。之所以说是类似，是因为我每次都是在电梯自身状态发生改变后获取当前的“货架”Scheduler内容，而不是Scheduler一有更新就通知Elevator（也可能这是某种设计模式但我不知道）。</p><p>这样设计的好处是，我只有Scheduler类的方法是上锁的，其他类调用时不需要考虑是否会引发线程不安全问题，写起来很方便；坏处是我现在还不是很熟悉lock的用法……</p><p>电梯内部则采用状态模式，设置了WAIT, OPEN, CLOSE, CLOSED, PASS, UP, DOWN多个枚举状态类型。</p><p>而对于对于存储人群信息的队列，我采用了单独的WaitMul、ElevatorMul封装<code>HashMap&lt;Integer, Queue&lt;Person&gt;&gt;</code>的方式，指向来去楼层，并配置各种方法，外部可以对Multitude进行塞人取人的操作，Multitude内部的存储方式是不透明的。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-性能优化策略">1.2 性能优化策略<a class="hash-link" href="#12-性能优化策略" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="121-第五次作业">1.2.1 第五次作业<a class="hash-link" href="#121-第五次作业" title="Direct link to heading">​</a></h4><p>性能上，本次作业我采用的是在SSTF的基础上，自己瞎琢磨的“选择最短路径”贪心算法，比较电梯原目标与反方向新目标的最短距离：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">minDistance</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> cntFloor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> goalFloor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> tmpFloor</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> tmpGoal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> dis1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">goalFloor </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> cntFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">goalFloor </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tmpFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmpGoal </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tmpFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> dis2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cntFloor </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tmpFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmpGoal </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tmpFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">goalFloor </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tmpGoal</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dis1 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> dis2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> tmpGoal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> goalFloor</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然而这种方法有很大的缺陷……在某些特定楼层会有小几率出现反复横跳……最后逼近截止时间一直在改，又增加了防止锁死的机制（当检测到死循环时弃用这一优化），代价是拉低了性能，最后性能分16多。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="122-第六次作业">1.2.2 第六次作业<a class="hash-link" href="#122-第六次作业" title="Direct link to heading">​</a></h4><p>感谢CJB，他在第五次作业得到很高的性能分，也慷概地将他的算法分享给了我们——</p><blockquote><p>sstf的基础上，当电梯里有人时候，选择最近上楼或最近出楼层的，就行，其他不变。</p><p>​		——《CJB语录》第二卷上册</p></blockquote><p>所以在第六次多电梯，我的单电梯也采用了相同（也许）的策略。</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">/***************</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * SSTF</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"> * *************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getGoalFloor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> cnt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">boolean</span><span class="token plain"> isEleFull</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 传入参数：电梯当前楼层、电梯满员状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">elevator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isEmpty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> scheduler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMinDisWhenEmpty</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cnt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> eleId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// 电梯为空时，按情况进入wait状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> inReq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> elevator</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMinDisReq</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cnt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> goalFloor</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isEleFull</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> inReq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// 电梯满员时，不考虑外部新请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> outReq </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> scheduler</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getMinDis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cnt</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> inReq</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> eleId</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outReq </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> LOST</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> inReq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// 外部没有请求，直接相应内部请求</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">outReq </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> cnt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token class-name">Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">abs</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">inReq </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> cnt</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> outReq </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> inReq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic">// 选择最近上楼或最近出电梯的</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>射射CJB！CJB, YYDS! 最后性能分19多。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="123-第七次作业">1.2.3 第七次作业<a class="hash-link" href="#123-第七次作业" title="Direct link to heading">​</a></h4><p>在第七次作业沿用了CJB的SSTF策略以及部分，为啥不用LOOK呢？我感觉这种性能分权重还是优先接人收益高。</p><p>而对于换乘，我用到了两组数组：</p><div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> canStopOfType </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*********1***********************9****************15****************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*********1***********************9****************15****************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">private</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">final</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">int</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> mustFromName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/********(1)**********************9***************(15)***************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">/*********1***********************9****************15****************/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">/*** A B C ***/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>canStopOfType</code>存储的是电梯可以停的楼层，<code>mustFromName</code>数组则是电梯必须接受这一楼层的请求（1和15层三个类型都可以，就让电梯自由竞争）。</p><p>换乘时会把人从电梯重新塞进等待队列，所以之后就与没有换乘的情况一样了。其实感觉5层作为换乘站也不错……后来不想改了……最后性能分19多。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二可扩展性">二、可扩展性<a class="hash-link" href="#二可扩展性" title="Direct link to heading">​</a></h2><p>(2)从功能设计和性能设计的平衡方面，更细和总结自己<strong>第三次作业</strong>架构设计的可扩展性</p><p>可扩展性方面，这一次一开始就希望能为后续的扩展留好迭代空间，在正式开始之前读了好多学长的博客，其中PMXM助教的博客给了我很大启发：</p><blockquote><p><a href="https://www.cnblogs.com/i-love-ange-and-oo-forever/p/10756828.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/i-love-ange-and-oo-forever/p/10756828.html</a></p></blockquote><p>最后迭代开发的效果还算马马虎虎……但每次加入新功能都会引入不少Bug，测试花的时间很多。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="功能设计">功能设计<a class="hash-link" href="#功能设计" title="Direct link to heading">​</a></h3><p>电梯是一台有限状态机，有WAIT, OPEN, CLOSE, CLOSED, PASS, UP, DOWN一共7种状态，三次作业的状态转移图都差不多，如下：![](G:\OneDrive\OneDrive - buaa.edu.cn\MWD\学习\面向对象设计与构造\博客2\电梯流程图.jpg)</p><p>这样做的优势是每部电梯自身都独挡一面，人可以随时选择最近的电梯、呼叫多部电梯，方便增加电梯数量的扩展。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="性能设计">性能设计<a class="hash-link" href="#性能设计" title="Direct link to heading">​</a></h3><p>根据上面那个丑哭的状态转移图可知，在CLOSED, PASS两种状态下会调用获取目标楼层的方法，因此我所有的优化都只要写在获取目标楼层的方法getGoalFloor中，同样有利于迭代开发，比如第七次作业的getGoalFloor方法和前面提到过的第六次作业getGoalFloor方法比较，完全没有变化。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="solid原则分析">SOLID原则分析<a class="hash-link" href="#solid原则分析" title="Direct link to heading">​</a></h3><p>以第七次作业分析：</p><ul><li>SRP原则：感觉还行，RequestParser将读取到的PersonRequest放到Scheduler上，ElevatorRequest则传入Controller用于创造新电梯；ElevatorController运送Scheduler上的乘客。</li><li>OCP原则：电梯封装的好，便于扩展数量，感觉这方面还行。</li><li>LSP原则：在第五次作业，对于WaitMul、ElevatorMul采用了继承的方式，但后来在第六、七次作业的优化中取消……所以应该没有怎么实现。</li><li>LOD原则：RequestParser与ElevatorController通过Scheduler转发调用，有独立性。</li><li>ISP原则：在本单元作业没有创建接口，部分线程实现了Runnable接口。三种电梯我是采用构造时传参的方式，配置工厂类Controller用于创造新电梯，所以也就没有实现接口的必要了。</li><li>DIP原则：感觉做的还可以……因为我都是人自己刷新要乘坐的电梯（但是因为没有给人开线程，所以都是由电梯调用人的选电梯方法，其实实现上来说更类似于电梯抢人），避免了为了优化带来的倒置依赖。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三度量分析">三、度量分析<a class="hash-link" href="#三度量分析" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-第五次作业">3.1 第五次作业<a class="hash-link" href="#31-第五次作业" title="Direct link to heading">​</a></h3><p>▼ 基本结构图，MainClass启动输入线程和电梯线程，外部的楼层等待人群和内部的电梯货运人群采用了继承抽象类人群的方式，将对人的存储方式封装起来。</p><p>▼ 时序图，用插件自动生成的，感觉不是很准确……感觉参看我的有限状态机图更好一点……</p><p>▼ 依赖关系，还可以。</p><table><thead><tr><th>Class</th><th>Cyclic</th><th>Dcy</th><th>Dcy*</th><th>Dpt</th><th>Dpt*</th></tr></thead><tbody><tr><td>homework.MainClass</td><td>0</td><td>3</td><td>10</td><td>0</td><td>0</td></tr><tr><td>homework.custumer.Elevator</td><td>0</td><td>4</td><td>5</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>0</td><td>0</td><td>0</td><td>2</td><td>3</td></tr><tr><td>homework.custumer.ElevatorController</td><td>0</td><td>3</td><td>8</td><td>1</td><td>1</td></tr><tr><td>homework.producer.RequestParser</td><td>0</td><td>2</td><td>5</td><td>1</td><td>1</td></tr><tr><td>homework.tray.MulInside</td><td>0</td><td>3</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.tray.MulOutside</td><td>0</td><td>3</td><td>3</td><td>1</td><td>4</td></tr><tr><td>homework.tray.Multitude</td><td>0</td><td>2</td><td>2</td><td>4</td><td>7</td></tr><tr><td>homework.tray.Multitude.Type</td><td>0</td><td>0</td><td>0</td><td>3</td><td>8</td></tr><tr><td>homework.tray.Person</td><td>0</td><td>0</td><td>0</td><td>6</td><td>8</td></tr><tr><td>homework.tray.Scheduler</td><td>0</td><td>3</td><td>4</td><td>3</td><td>3</td></tr></tbody></table><p>▼ 复杂度，ElevatorController作为一台大状态机以及“抢人”的独立个体，自身的run方法作为状态机判断条件很多，圈复杂度也飘红；获取最优目标的getGoal方法这次写的很复杂……</p><table><thead><tr><th>Method</th><th>ev(G)</th><th>iv(G)</th><th>v(G)</th></tr></thead><tbody><tr><td>homework.MainClass.main(String[])</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.Elevator()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.close(HashMap&lt;Person,  Integer&gt;)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getCurrentFloor()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getMinTimeReq(int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getStatus()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.isEmpty()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.move(boolean)</td><td>1</td><td>4</td><td>4</td></tr><tr><td>homework.custumer.Elevator.open()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.setStatus(Status)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.sleepTime(int)</td><td>1</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorController.ElevatorController(Scheduler)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorController.getGoal1(int)</td><td>5</td><td>3</td><td>5</td></tr><tr><td>homework.custumer.ElevatorController.getGoal2(int)</td><td>6</td><td>3</td><td>7</td></tr><tr><td>homework.custumer.ElevatorController.getGoalFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorController.getGoalFloor2(int)</td><td>2</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorController.moveJudge(int)</td><td>2</td><td>2</td><td>6</td></tr><tr><td>homework.custumer.ElevatorController.run()</td><td>2</td><td>8</td><td>15</td></tr><tr><td>homework.custumer.ElevatorController.setDie2(boolean)</td><td>2</td><td>1</td><td>10</td></tr><tr><td>homework.producer.RequestParser.RequestParser(Scheduler)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.producer.RequestParser.run()</td><td>3</td><td>3</td><td>4</td></tr><tr><td>homework.tray.MulInside.MulInside()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.MulInside.addInsideMul(HashMap&lt;Person,  Integer&gt;)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.MulInside.makeMultitudeOut(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.MulOutside.MulOutside()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.MulOutside.addOutsideMul(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.Multitude(Type)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.Multitude.cloneMulInFloor(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.Multitude.convertFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.getList()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.getMaxFloor()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.getMinDisFloor(int,int,int)</td><td>14</td><td>3</td><td>17</td></tr><tr><td>homework.tray.Multitude.getMinFloor()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.getMulInFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.isEmpty()</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.Multitude.isEmptyFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Multitude.removeMulInFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.Person(PersonRequest)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.Person(int,int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.clone()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.equals(Object)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.Person.getFr()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getTo()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.hashCode()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonIn()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonOut()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.moveUp()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.Scheduler()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.getMinDisFloor(int,int)</td><td>1</td><td>4</td><td>4</td></tr><tr><td>homework.tray.Scheduler.getOtherReq(int,int)</td><td>7</td><td>11</td><td>13</td></tr><tr><td>homework.tray.Scheduler.hasPassReqInFloor(int,int)</td><td>4</td><td>3</td><td>4</td></tr><tr><td>homework.tray.Scheduler.hasRequestInFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.makeMulIn(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.Scheduler.minDistance(int,int,int,int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.Scheduler.readNewRequest(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopReading()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopTask()</td><td>1</td><td>1</td><td>1</td></tr></tbody></table><p>类复杂度上，ElevatorController飘红。</p><table><thead><tr><th>homework.MainClass</th><th>1</th><th>1</th></tr></thead><tbody><tr><td>homework.custumer.Elevator</td><td>1.3</td><td>13</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>n/a</td><td>0</td></tr><tr><td>homework.custumer.ElevatorController</td><td>5.12</td><td>41</td></tr><tr><td>homework.producer.RequestParser</td><td>2</td><td>4</td></tr><tr><td>homework.tray.MulInside</td><td>1.67</td><td>5</td></tr><tr><td>homework.tray.MulOutside</td><td>1</td><td>2</td></tr><tr><td>homework.tray.Multitude</td><td>2.55</td><td>28</td></tr><tr><td>homework.tray.Multitude.Type</td><td>n/a</td><td>0</td></tr><tr><td>homework.tray.Person</td><td>1.1</td><td>11</td></tr><tr><td>homework.tray.Scheduler</td><td>2.6</td><td>26</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-第六次作业">3.2 第六次作业<a class="hash-link" href="#32-第六次作业" title="Direct link to heading">​</a></h3><p>▼ 基本结构图，MainClass启动输入线程和多个电梯线程，这次放弃了继承，并且优化了传递人员的方式，降低了耦合性。</p><p>▼ 时序图。</p><p>▼ 依赖关系，这次的架构是在第五次的基础上修改，也差不多。</p><table><thead><tr><th>Class</th><th>Cyclic</th><th>Dcy</th><th>Dcy*</th><th>Dpt</th><th>Dpt*</th></tr></thead><tbody><tr><td>homework.MainClass</td><td>0</td><td>3</td><td>9</td><td>0</td><td>0</td></tr><tr><td>homework.custumer.Controller</td><td>0</td><td>2</td><td>7</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator</td><td>0</td><td>3</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>0</td><td>0</td><td>0</td><td>2</td><td>4</td></tr><tr><td>homework.custumer.ElevatorController</td><td>0</td><td>3</td><td>6</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul</td><td>0</td><td>1</td><td>1</td><td>1</td><td>4</td></tr><tr><td>homework.producer.RequestParser</td><td>0</td><td>2</td><td>3</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person</td><td>0</td><td>0</td><td>0</td><td>5</td><td>8</td></tr><tr><td>homework.tray.Scheduler</td><td>0</td><td>2</td><td>2</td><td>4</td><td>4</td></tr><tr><td>homework.tray.WaitMul</td><td>0</td><td>1</td><td>1</td><td>1</td><td>5</td></tr></tbody></table><p>▼ 复杂度，几个寻找最优解的方法都较为复杂，比如getBestOne中用了大量循环遍历比较获取最小值，基本复杂度和圈复杂度都比较差。</p><table><thead><tr><th>Method</th><th>ev(G)</th><th>iv(G)</th><th>v(G)</th></tr></thead><tbody><tr><td>homework.MainClass.main(String[])</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller.Controller(int,Scheduler)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller.run()</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.Elevator.Elevator(char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.close()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getCurrentFloor()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getMinDisReq(int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getStatus()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.isEmpty()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.isFull()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.move(boolean)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.open()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.putOne(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.setStatus(Status)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.sleepTime(int)</td><td>1</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.Elevator.updateCurrentFloor(boolean)</td><td>1</td><td>1</td><td>4</td></tr><tr><td>homework.custumer.ElevatorController.ElevatorController(Scheduler,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorController.eleClose(int)</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.custumer.ElevatorController.eleClosed(int,boolean)</td><td>1</td><td>5</td><td>6</td></tr><tr><td>homework.custumer.ElevatorController.eleWait(int,boolean)</td><td>2</td><td>4</td><td>4</td></tr><tr><td>homework.custumer.ElevatorController.getGoalFloor(int,boolean)</td><td>4</td><td>3</td><td>5</td></tr><tr><td>homework.custumer.ElevatorController.run()</td><td>2</td><td>4</td><td>11</td></tr><tr><td>homework.custumer.ElevatorMul.ElevatorMul()</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.convertInFloor(int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.custumer.ElevatorMul.convertOutFloor(int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.getMinDisReq(int,int)</td><td>8</td><td>3</td><td>12</td></tr><tr><td>homework.custumer.ElevatorMul.isEleEmpty()</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.isEleFull()</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.mulOut(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.putOne(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorMul.updateEleSize(boolean)</td><td>1</td><td>1</td><td>2</td></tr><tr><td>homework.producer.RequestParser.RequestParser(Scheduler,ElevatorInput)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.producer.RequestParser.run()</td><td>3</td><td>3</td><td>4</td></tr><tr><td>homework.tray.Person.Person(PersonRequest)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.eleIdNull()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.equals(Object)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.Person.getEl()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getFr()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getId()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getMoveDis()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getTo()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getWaitDis()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.hashCode()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonIn()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonOut()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.moveUp()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.sameForward(boolean)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setEl(char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setWaitDis(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.toString()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.Scheduler()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.failToGetOne(int,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.getMinDis(int,int,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.getMinDisWhenEmpty(int,char)</td><td>1</td><td>4</td><td>4</td></tr><tr><td>homework.tray.Scheduler.getOne(int,int,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.hasRequestInFloor(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.readNewRequest(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopReading()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopTask()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.updateFlag(int,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.WaitMul()</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.WaitMul.addOutsideMul(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.convertInFloor(int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.tray.WaitMul.convertOutFloor(int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.WaitMul.failToGetOne(int,char)</td><td>6</td><td>5</td><td>7</td></tr><tr><td>homework.tray.WaitMul.getBestOne(int,int,char)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.getMinDisFloor(int,int,char)</td><td>8</td><td>3</td><td>12</td></tr><tr><td>homework.tray.WaitMul.hasRequestInFloor(int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.WaitMul.isEmpty()</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.WaitMul.searchBestOne(int,int,int,char)</td><td>4</td><td>7</td><td>9</td></tr><tr><td>homework.tray.WaitMul.updateFlag(int,char)</td><td>1</td><td>4</td><td>4</td></tr></tbody></table><p>类复杂度上，这次的WaitMul设计由于放弃了继承关系，也不是很乐观。</p><table><thead><tr><th>Class</th><th>OCavg</th><th>WMC</th></tr></thead><tbody><tr><td>homework.MainClass</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller</td><td>1.5</td><td>3</td></tr><tr><td>homework.custumer.Elevator</td><td>1.23</td><td>16</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>n/a</td><td>0</td></tr><tr><td>homework.custumer.ElevatorController</td><td>4.17</td><td>25</td></tr><tr><td>homework.custumer.ElevatorMul</td><td>3</td><td>27</td></tr><tr><td>homework.producer.RequestParser</td><td>2</td><td>4</td></tr><tr><td>homework.tray.Person</td><td>1.06</td><td>18</td></tr><tr><td>homework.tray.Scheduler</td><td>1.1</td><td>11</td></tr><tr><td>homework.tray.WaitMul</td><td>3.91</td><td>43</td></tr></tbody></table><h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-第七次作业">3.3 第七次作业<a class="hash-link" href="#33-第七次作业" title="Direct link to heading">​</a></h3><p>▼ 基本结构图，MainClass启动输入线程和电梯线程。</p><p>▼ 时序图，这次加了SafeOutput的封装，虽然不加也没什么影响……</p><p>▼ 依赖关系，同第六次作业。</p><table><thead><tr><th>Class</th><th>Cyclic</th><th>Dcy</th><th>Dcy*</th><th>Dpt</th><th>Dpt*</th></tr></thead><tbody><tr><td>homework.MainClass</td><td>6</td><td>2</td><td>12</td><td>3</td><td>6</td></tr><tr><td>homework.SafeOutput</td><td>0</td><td>0</td><td>0</td><td>2</td><td>9</td></tr><tr><td>homework.custumer.Controller</td><td>6</td><td>2</td><td>12</td><td>1</td><td>6</td></tr><tr><td>homework.custumer.Elevator</td><td>6</td><td>6</td><td>12</td><td>1</td><td>6</td></tr><tr><td>homework.custumer.Elevator.EleTime</td><td>0</td><td>0</td><td>0</td><td>2</td><td>7</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>0</td><td>0</td><td>0</td><td>2</td><td>7</td></tr><tr><td>homework.custumer.ElevatorController</td><td>6</td><td>6</td><td>12</td><td>1</td><td>6</td></tr><tr><td>homework.custumer.ElevatorMul</td><td>0</td><td>1</td><td>2</td><td>1</td><td>7</td></tr><tr><td>homework.producer.RequestParser</td><td>6</td><td>3</td><td>12</td><td>1</td><td>6</td></tr><tr><td>homework.tray.Person</td><td>0</td><td>1</td><td>1</td><td>6</td><td>8</td></tr><tr><td>homework.tray.Scheduler</td><td>6</td><td>2</td><td>12</td><td>4</td><td>6</td></tr><tr><td>homework.tray.WaitMul</td><td>6</td><td>3</td><td>12</td><td>1</td><td>6</td></tr></tbody></table><p>▼ 复杂度，问题和之前的都差不多。</p><table><thead><tr><th>Method</th><th>ev(G)</th><th>iv(G)</th><th>v(G)</th></tr></thead><tbody><tr><td>homework.MainClass.main(String[])</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.SafeOutput.println(String)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller.Controller(Scheduler)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller.addElevator(ElevatorRequest)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller.convertType(String)</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.custumer.Controller.run()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.Elevator(String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.close()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getCurrentFloor()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getMinDisReq(int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.getStatus()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.inOne(Person)</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.custumer.Elevator.isEmpty()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.isFull()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.move(boolean)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.open()</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.custumer.Elevator.outOne()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.setStatus(Status)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Elevator.sleepTime(EleTime)</td><td>2</td><td>2</td><td>5</td></tr><tr><td>homework.custumer.Elevator.updateCurrentFloor(boolean)</td><td>1</td><td>1</td><td>4</td></tr><tr><td>homework.custumer.ElevatorController.ElevatorController(Scheduler,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorController.eleClose(int)</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.custumer.ElevatorController.eleClosed(int,boolean)</td><td>1</td><td>5</td><td>6</td></tr><tr><td>homework.custumer.ElevatorController.eleOpen(int)</td><td>3</td><td>4</td><td>4</td></tr><tr><td>homework.custumer.ElevatorController.eleWait(int,boolean)</td><td>2</td><td>5</td><td>5</td></tr><tr><td>homework.custumer.ElevatorController.getGoalFloor(int,boolean)</td><td>4</td><td>3</td><td>5</td></tr><tr><td>homework.custumer.ElevatorController.run()</td><td>2</td><td>5</td><td>12</td></tr><tr><td>homework.custumer.ElevatorMul.ElevatorMul(int,int[])</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.convertIn(int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.custumer.ElevatorMul.convertOut(int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.getMinDisReq(int,int)</td><td>8</td><td>3</td><td>12</td></tr><tr><td>homework.custumer.ElevatorMul.inOne(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.ElevatorMul.isEleEmpty()</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.isEleFull()</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.mulOut(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.outOne(int)</td><td>2</td><td>2</td><td>2</td></tr><tr><td>homework.custumer.ElevatorMul.updateEleSize(boolean)</td><td>1</td><td>1</td><td>2</td></tr><tr><td>homework.producer.RequestParser.RequestParser(Scheduler)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.producer.RequestParser.run()</td><td>3</td><td>5</td><td>6</td></tr><tr><td>homework.tray.Person.Person(PersonRequest)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.eleIdNull()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.equals(Object)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.Person.getEl()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getFr()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getId()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getMoveDis()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getTo()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getTransfer()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.getWaitTime()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.hashCode()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonIn()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.makePersonOut()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.moveUp()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.sameForward(boolean)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setEl(String)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setFr(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setTransfer(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.setWaitTime(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.toString()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Person.transferPerson(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.Scheduler()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.failToGetOne(int,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.getMinDis(int,int,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.getMinDisWhenEmpty(int,String,int)</td><td>2</td><td>5</td><td>6</td></tr><tr><td>homework.tray.Scheduler.getOne(int,int,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.hasRequestInFloor(int,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.readNewRequest(Person)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopReading()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.stopTask()</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.tranOfTypeIsEmpty(int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.Scheduler.updateFlag(int,String,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.WaitMul()</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.tray.WaitMul.addOutsideMul(Person)</td><td>3</td><td>2</td><td>5</td></tr><tr><td>homework.tray.WaitMul.canStopIn(int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.convertIn(int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.tray.WaitMul.convertOut(int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.WaitMul.failToGetOne(int,String,int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.tray.WaitMul.getBestOne(int,int,String,int)</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.tray.WaitMul.getDisOfTran(int,int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.getEleType(int)</td><td>3</td><td>1</td><td>3</td></tr><tr><td>homework.tray.WaitMul.getInsideTransfer(int,int)</td><td>4</td><td>4</td><td>14</td></tr><tr><td>homework.tray.WaitMul.getInsideTransfer(int,int,int,int)</td><td>2</td><td>3</td><td>4</td></tr><tr><td>homework.tray.WaitMul.getMinDisFloor(int,int,String,int)</td><td>2</td><td>4</td><td>4</td></tr><tr><td>homework.tray.WaitMul.getMinDisPerson(int,int,String,int)</td><td>4</td><td>2</td><td>8</td></tr><tr><td>homework.tray.WaitMul.getMinDownFloorReq(int,int,String,int)</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.WaitMul.getMinUpFloorReq(int,int,String,int)</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.WaitMul.getTranOfType(int)</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.WaitMul.hasRequestInFloor(int,int,String,int)</td><td>2</td><td>1</td><td>2</td></tr><tr><td>homework.tray.WaitMul.isEmpty()</td><td>3</td><td>2</td><td>3</td></tr><tr><td>homework.tray.WaitMul.mustTakeIn(int,int)</td><td>1</td><td>1</td><td>1</td></tr><tr><td>homework.tray.WaitMul.removeOneInTran(int)</td><td>1</td><td>3</td><td>3</td></tr><tr><td>homework.tray.WaitMul.searchInFloor(int,int,int,String,int)</td><td>6</td><td>7</td><td>12</td></tr><tr><td>homework.tray.WaitMul.tranOfTypeIsEmpty(int)</td><td>1</td><td>2</td><td>2</td></tr><tr><td>homework.tray.WaitMul.tranPut(int,int,int)</td><td>1</td><td>4</td><td>4</td></tr><tr><td>homework.tray.WaitMul.tranWait(int,int)</td><td>2</td><td>1</td><td>3</td></tr><tr><td>homework.tray.WaitMul.updateFlag(int,String,int)</td><td>1</td><td>4</td><td>4</td></tr></tbody></table><p>类复杂度也一样。</p><table><thead><tr><th>Class</th><th>OCavg</th><th>WMC</th></tr></thead><tbody><tr><td>homework.MainClass</td><td>1</td><td>1</td></tr><tr><td>homework.SafeOutput</td><td>1</td><td>1</td></tr><tr><td>homework.custumer.Controller</td><td>1.5</td><td>6</td></tr><tr><td>homework.custumer.Elevator</td><td>1.57</td><td>22</td></tr><tr><td>homework.custumer.Elevator.EleTime</td><td>n/a</td><td>0</td></tr><tr><td>homework.custumer.Elevator.Status</td><td>n/a</td><td>0</td></tr><tr><td>homework.custumer.ElevatorController</td><td>4.29</td><td>30</td></tr><tr><td>homework.custumer.ElevatorMul</td><td>2.9</td><td>29</td></tr><tr><td>homework.producer.RequestParser</td><td>3</td><td>6</td></tr><tr><td>homework.tray.Person</td><td>1.05</td><td>22</td></tr><tr><td>homework.tray.Scheduler</td><td>1.18</td><td>13</td></tr><tr><td>homework.tray.WaitMul</td><td>3.24</td><td>81</td></tr></tbody></table><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四三省吾身">四、三省吾身<a class="hash-link" href="#四三省吾身" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-第五次作业">4.1 第五次作业<a class="hash-link" href="#41-第五次作业" title="Direct link to heading">​</a></h3><p>本次作业在强测中没有出现Bug，在互测中没有被Hack。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-第六次作业">4.2 第六次作业<a class="hash-link" href="#42-第六次作业" title="Direct link to heading">​</a></h3><p>本次作业在强测中没有出现Bug，在互测中没有被Hack。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-第七次作业">4.3 第七次作业<a class="hash-link" href="#43-第七次作业" title="Direct link to heading">​</a></h3><p>本次作业在强测中没有出现Bug，在互测中被Hack一次。</p><p>这次很惨地被Rider暴捶，Rider实在是一个居住在OO网站上的狠人，最终战绩30 / 168，从头到尾穷追不舍Berserker，hack了我试了好几次也打不到的Alterego（我本地会测出他有死锁的情况），用运行超时死锁虐了我和Saber……</p><p>Rider从头到尾就在提交一个数据（除了固定欺负Berserker，还会捎带暴捶我们）：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[1.0]651-FROM-5-TO-15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1.0]404-FROM-9-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5.0]797-FROM-10-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5.0]75-FROM-2-TO--2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5.0]816-FROM-1-TO-7</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[5.0]699-FROM-9-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]46-FROM-11-TO-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]592-FROM--3-TO--2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]152-FROM-1-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]480-FROM-1-TO-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]385-FROM--3-TO-6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]199-FROM--3-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]632-FROM-13-TO-20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]562-FROM-6-TO-12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[9.0]72-FROM-9-TO-4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]995-FROM-1-TO--2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]977-FROM-1-TO-12</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]633-FROM-1-TO-3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]176-FROM-1-TO-11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]865-FROM-2-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]471-FROM-8-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]594-FROM-11-TO-4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]765-FROM-3-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[13.0]478-FROM-1-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]357-FROM-1-TO-11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]604-FROM-9-TO-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]447-FROM-1-TO-10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]106-FROM-9-TO-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]194-FROM-7-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]387-FROM-12-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]760-FROM-1-TO-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]X1-ADD-ELEVATOR-C</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]874-FROM-16-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]369-FROM-1-TO-9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]268-FROM-8-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]498-FROM--3-TO-5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]340-FROM-10-TO-4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]859-FROM-1-TO-8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]423-FROM-1-TO-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[17.0]211-FROM--1-TO-2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21.0]518-FROM-17-TO-14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[21.0]242-FROM-10-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[25.0]871-FROM--3-TO-6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[25.0]427-FROM--1-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[25.0]X2-ADD-ELEVATOR-A</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]975-FROM-14-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]504-FROM-1-TO--1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]942-FROM-1-TO--1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]96-FROM-1-TO--1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]133-FROM--3-TO-1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]558-FROM-15-TO--3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[29.0]X3-ADD-ELEVATOR-A</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>单看数据，这组数据的特点是分几个时间段，在同一时刻进行大量乘客投放和电梯增加操作。</p><p>那么为什么会发生死锁呢？相信我们房间的同学都很想了解为什么会发生死锁，小编对于会发生死锁这件事也感到很惊讶，但是就是发生死锁了，那么这就是发生死锁的故事了。对于这件事情大家有什么看法呢，欢迎在评论区留言哦。</p><p>……言归正传……我本地将这个数据跑了1000次，也没有成功复现。而根据课程组提供的加密输出，可以发现产生死锁的样例输出中间有明显间隔期，然而CPU时间为1.2s，说明没有发生暴力轮询，而我所采用的架构是人类在每次电梯发生楼层改变时都会重新呼叫当前最近的电梯，所以……我是真的想不出来原因了……解决办法就是给wait价格时间限制试试？但我也不清楚这个的作用，毕竟直接再交一遍也过了……</p><p>以上，互测被扣分了是我能力不够，等解禁了一定要加Rider膜拜一下，对于这个问题我也不会忘记的，以后姿势水平提升了要努力弄明白。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="五互测策略">五、互测策略<a class="hash-link" href="#五互测策略" title="Direct link to heading">​</a></h2><p>第五、六次没有发现他人Bug，但是第六次有房间成员发现他人Bug……第七次发现3处Bug，Hack成功2处。</p><p>在互测时发现了别人的线程不安全Bug：</p><ul><li>调度器类使用for each遍历当前电梯列表，如果这时出现新的电梯添加请求（迭代过程中进行了修改），就会抛异常。（提交4次数据成功1次）</li></ul><p>而互测策略上，这次就没有对拍……多线程主要依赖自动测试，感谢HDL学长的定时输入轮子和某位学长的自动化测试机和WPB的多线程评测机。这里再次膜拜一下一个样例提交20多次的居住在OO网站上的Rider。</p><p>一些卡时间点的数据我试了下无人中招……毕竟对自己的性能有一点自信，所以当时互测就没有深入测试……这里再次膜拜一下卡RTLE的居住在OO网站上的Rider。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="六心得体会">六、心得体会<a class="hash-link" href="#六心得体会" title="Direct link to heading">​</a></h2><p>从难度上来说，我觉得第二单元比第一单元略小。第一单元为了性能和正确性，需要考虑的东西还挺多的。而虽然说相比去年今年第二单元的进度提早、需求增加，但是有了第一单元学习到的经验，迭代开发使得三次作业的改进更加方便。</p><p>这一单元关于锁的概念理解与实际操作非常重要，我主要使用synchronized关键字修饰单一类的方法，发生死锁的概率较低。而多线程也对自动化测试有了更高的要求，之后也要强化Python编程能力。</p><p>不过这三次还是花了很多时间在修复Bug上，希望下次可以避免。</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>这是一篇从Hexo迁移的文章，创建于2020-04-09 17:20:43</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/BUAA/本科/面向对象设计与构造/OO-JML语言理论基础与工具链总结"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">2020 OO JML语言理论基础与工具链总结</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/BUAA/本科/面向对象设计与构造/OO-第四单元总结"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">2020 OO 第四单元总结</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一设计策略" class="table-of-contents__link toc-highlight">一、设计策略</a><ul><li><a href="#11-总体策略概述" class="table-of-contents__link toc-highlight">1.1 总体策略概述</a></li><li><a href="#12-性能优化策略" class="table-of-contents__link toc-highlight">1.2 性能优化策略</a></li></ul></li><li><a href="#二可扩展性" class="table-of-contents__link toc-highlight">二、可扩展性</a><ul><li><a href="#功能设计" class="table-of-contents__link toc-highlight">功能设计</a></li><li><a href="#性能设计" class="table-of-contents__link toc-highlight">性能设计</a></li><li><a href="#solid原则分析" class="table-of-contents__link toc-highlight">SOLID原则分析</a></li></ul></li><li><a href="#三度量分析" class="table-of-contents__link toc-highlight">三、度量分析</a><ul><li><a href="#31-第五次作业" class="table-of-contents__link toc-highlight">3.1 第五次作业</a></li><li><a href="#32-第六次作业" class="table-of-contents__link toc-highlight">3.2 第六次作业</a></li><li><a href="#33-第七次作业" class="table-of-contents__link toc-highlight">3.3 第七次作业</a></li></ul></li><li><a href="#四三省吾身" class="table-of-contents__link toc-highlight">四、三省吾身</a><ul><li><a href="#41-第五次作业" class="table-of-contents__link toc-highlight">4.1 第五次作业</a></li><li><a href="#42-第六次作业" class="table-of-contents__link toc-highlight">4.2 第六次作业</a></li><li><a href="#43-第七次作业" class="table-of-contents__link toc-highlight">4.3 第七次作业</a></li></ul></li><li><a href="#五互测策略" class="table-of-contents__link toc-highlight">五、互测策略</a></li><li><a href="#六心得体会" class="table-of-contents__link toc-highlight">六、心得体会</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.f1753f1f.js"></script>
<script src="/assets/js/main.b373ddf5.js"></script>
</body>
</html>